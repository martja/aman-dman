$schema: "https://json-schema.org/draft/2020-12/schema"
title: "Timelines Config"
description: "Schema for arrival/departure timelines, tag layouts, aliases, and ATC connection settings"
type: object
required: ["timelines", "arrivalLabelLayouts", "connectionConfig"]
additionalProperties: false

properties:
  timelines:
    type: object
    description: "Map of airport ICAO codes to timeline definitions"
    patternProperties:
      "^[A-Z]{4}$":
        type: array
        items:
          type: object
          required: ["timelineTitle", "right", "arrivalLabelLayoutId"]
          properties:
            timelineTitle:
              type: string
              description: "Timeline title"
            arrivalLabelLayoutId:
              type: string
              description: "ID of the arrival tag layout to use"
            left:
              oneOf:
                - $ref: "#/$defs/side"
                - type: "null"
              description: "Left side of the timeline; can be null for single-sided layouts."
            right:
              $ref: "#/$defs/side"
              description: "Right side of the timeline."
          additionalProperties: false
    additionalProperties: false

  arrivalLabelLayouts:
    type: object
    description: "Map of layout names to arrays of tag item definitions"
    patternProperties:
      "^[a-zA-Z0-9_-]+$":
        type: array
        items:
          type: object
          required: ["src", "w"]
          properties:
            src:
              type: string
              description: "Data source for the tag field (e.g., assignedRunway, departureTime)"
            w:
              type: integer
              minimum: 1
              description: "Width of the tag field"
            def:
              type: string
              description: "Optional default value for the tag"
            via:
              type: boolean
              description: "Marks this tag as a via-fix indicator"
            align:
              type: string
              enum: ["left", "right"]
              default: "left"
              description: "Text alignment"
            maxLen:
              type: integer
              minimum: 1
              description: "If the value is longer than this, it will be truncated"
          additionalProperties: false
    additionalProperties: false

  connectionConfig:
    type: object
    required: ["atcClient", "api"]
    properties:
      atcClient:
        type: object
        required: ["host", "port"]
        properties:
          host:
            type: string
            description: "Host for ATC client connection"
          port:
            type: integer
            minimum: 1
            maximum: 65535
            description: "Port for ATC client connection"
        additionalProperties: false
      api:
        type: object
        required: ["host"]
        properties:
          host:
            type: string
            format: uri
            description: "Base URL for external API"
        additionalProperties: false
    additionalProperties: false

$defs:
  side:
    type: object
    required: ["runways"]
    properties:
      runways:
        type: array
        items:
          type: string
          pattern: "^[0-9]{2}[A-Z]?$"
          description: "Runway identifier (e.g., 01L, 19R)"
    additionalProperties: false